<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Practice 10</title>
  </head>
  <body>
    <header>
      <h1><a href="#link-1">Esse reprehenderit</a></h1>
      <p>culpa nulla cillum do officia elit culpa dolor.</p>
    </header>
    <hr>
    <section id="editor">
      <h2>Live Preview</h2>
      <form action="" id="post-creation-form">
        <p>
          <label for="title">Title</label>
          <input type="text" id="title-input" name="title" value="" />
        </p>
        <p>
          <label for="content">Content</label>
          <textarea id="content-input" name="content"></textarea>
        </p>
        <p><input type="submit" value="Add to page" /></p>
      </form>
    </section>
    <section id="content">
      <ul class="posts">
          <li class="post">
              <h2 class="entry-title"><a href="#">Aliquip</a></h2>
              <div class="entry-content">
                <p>Culpa nulla cillum do officia elit culpa dolor.</p>
              </div>
          </li>
        </ul>
    </section>
  </body>
  <script>
    
    // 10. Create a form with an input and textarea that let's you add a post title and content.  Create a live preview of the form that let's you see what the title and content would look like on the page.

    var postList = document.querySelector('.posts');
    var postCreationForm = document.getElementById('post-creation-form');
    var titleInput = document.getElementById('title-input');
    var contentInput = document.getElementById('content-input');

    var newPostPreviewActive = false;
    var newPostPreview = null;
    var newPostTitle = null;
    var newPostContent = null;

    var genericPost = document.createElement('li');
    var genericEntryTitle = document.createElement('h2');
    var genericEntryTitleLink = document.createElement('a');
    var genericEntryContent = document.createElement('div');
    var genericParagraph = document.createElement('p');

    genericPost.classList.add('post');
    genericEntryTitle.classList.add('entry-title');
    genericEntryContent.classList.add('entry-content');

    genericEntryTitleLink.href = '#';

    genericPost.appendChild(genericEntryTitle);
    genericPost.appendChild(genericEntryContent);
    genericEntryTitle.appendChild(genericEntryTitleLink);
    genericEntryContent.appendChild(genericParagraph);

    postCreationForm.addEventListener('submit', formSubmitHandler )
    titleInput.addEventListener('input', titleChangeHandler );
    contentInput.addEventListener('input', contentChangeHandler );

    function createPost( title, content ) {
      var genericPost = document.createElement('li');
      var genericEntryTitle = document.createElement('h2');
      var genericEntryTitleLink = document.createElement('a');
      var genericEntryContent = document.createElement('div');
      var genericParagraph = document.createElement('p');

      genericPost.classList.add('post');
      genericEntryTitle.classList.add('entry-title');
      genericEntryContent.classList.add('entry-content');

      genericEntryTitleLink.href = '#';

      genericEntryTitleLink.innerText = title;
      genericParagraph.innerText = content;

      genericPost.appendChild(genericEntryTitle);
      genericPost.appendChild(genericEntryContent);
      genericEntryTitle.appendChild(genericEntryTitleLink);
      genericEntryContent.appendChild(genericParagraph);
      return genericPost;
    };

    function formSubmitHandler(event) {
      event.preventDefault();
      newPost = genericPost.cloneNode(true);
      titleInput.value = "";
      contentInput.value = "";
      genericEntryTitleLink.innerText = "";
      genericParagraph.innerText = "";
      postList.appendChild(newPost);
      newPostPreview = false;
    }

    function titleChangeHandler(event) {
      if (event.target.value === "") {
        return;
      }
      if (newPostPreview) {
        newPostPreview.remove();
      }
      console.log("executed");
      var title = event.target.value;
      newPostTitle = title;
      newPostPreview = createPost( newPostTitle, newPostContent );
      postList.appendChild(newPostPreview);
    }

    function contentChangeHandler(event) {
      if (event.target.value === "") {
        return;
      }
      if (newPostPreview) {
        newPostPreview.remove();
      }
      console.log("executed");
      var content = event.target.value;
      newPostContent = content;
      newPostPreview = createPost( newPostTitle, newPostContent );
      postList.appendChild(newPostPreview);
    }
  
  </script>
</html>
